estimate[1,i]=z[i]
estimate[2,i]=qnorm(sig[i],0,sqrt(6/m))
}
estimate
set.seed(123)
m <- 1000
N <- 1000
f<- function(x){
1/sqrt(2*pi)*exp(-x^2/2)
}
y <- numeric(m)
for(i in 1:m){
x <- rnorm(N,0,1)
m2 <- sum((x-mean(x))^2)/N
m3 <- sum((x-mean(x))^3)/N
y[i]=m3/(m2^(3/2))
}
sig <- c(0.025,0.05,0.95,0.975)
z <- sort(y)[sig*m]
var <- numeric(4)
sd <- numeric(4)
for(i in 1:4){
var[i]=(sig[i]*(1-sig[i]))/(m*f(z[i])^2)
sd[i]=sqrt(var[i])
}
print(Monte Carlo得到的四个分位数对应的方差分别为：)
set.seed(123)
m <- 1000
N <- 1000
f<- function(x){
1/sqrt(2*pi)*exp(-x^2/2)
}
y <- numeric(m)
for(i in 1:m){
x <- rnorm(N,0,1)
m2 <- sum((x-mean(x))^2)/N
m3 <- sum((x-mean(x))^3)/N
y[i]=m3/(m2^(3/2))
}
sig <- c(0.025,0.05,0.95,0.975)
z <- sort(y)[sig*m]
var <- numeric(4)
sd <- numeric(4)
for(i in 1:4){
var[i]=(sig[i]*(1-sig[i]))/(m*f(z[i])^2)
sd[i]=sqrt(var[i])
}
cat("Monte Carlo得到的四个分位数对应的方差分别为：",sd)
print(sd)
#大样本对比
estimate <- matrix(0,2,4)
for(i in 1:4){
estimate[1,i]=z[i]
estimate[2,i]=qnorm(sig[i],0,sqrt(6/m))
}
estimate
set.seed(123)
m <- 1000
N <- 1000
f<- function(x){
1/sqrt(2*pi)*exp(-x^2/2)
}
y <- numeric(m)
for(i in 1:m){
x <- rnorm(N,0,1)
m2 <- sum((x-mean(x))^2)/N
m3 <- sum((x-mean(x))^3)/N
y[i]=m3/(m2^(3/2))
}
sig <- c(0.025,0.05,0.95,0.975)
z <- sort(y)[sig*m]
var <- numeric(4)
sd <- numeric(4)
for(i in 1:4){
var[i]=(sig[i]*(1-sig[i]))/(m*f(z[i])^2)
sd[i]=sqrt(var[i])
}
cat("Monte Carlo得到的四个分位数对应的方差分别为：",sd)
#大样本对比
estimate <- matrix(0,2,4)
for(i in 1:4){
estimate[1,i]=z[i]
estimate[2,i]=qnorm(sig[i],0,sqrt(6/m))
}
estimate
set.seed(123)
m <- 1000
N <- 1000
f<- function(x){
1/sqrt(2*pi)*exp(-x^2/2)
}
y <- numeric(m)
for(i in 1:m){
x <- rnorm(N,0,1)
m2 <- sum((x-mean(x))^2)/N
m3 <- sum((x-mean(x))^3)/N
y[i]=m3/(m2^(3/2))
}
sig <- c(0.025,0.05,0.95,0.975)
z <- sort(y)[sig*m]
var <- numeric(4)
sd <- numeric(4)
for(i in 1:4){
var[i]=(sig[i]*(1-sig[i]))/(m*f(z[i])^2)
sd[i]=sqrt(var[i])
}
cat("Monte Carlo得到的四个分位数对应的标准误差分别为：",sd)
#大样本对比
estimate <- matrix(0,2,4)
for(i in 1:4){
estimate[1,i]=z[i]
estimate[2,i]=qnorm(sig[i],0,sqrt(6/m))
}
estimate
p <- 0.7
n <- seq(1000,10000,100)
n
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.5,0.95)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.5,0.95)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
level
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.5,0.95)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p && upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p and upper>p)
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p )
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
print(s)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
print(p_hat)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n*p_hat*(1-p_hat))
print(lower,upper)
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
print(lower,upper)
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
upper <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
print(lower)
print(upper)
level[i,j] <- mean(lower<p & upper>p)
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
m <- 1000
n <- c(1000,5000,10000)
alpha <- c(0.05,0.1,0.2)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
lower = numeric(m)
upper = numeric(m)
for(k in 1:m){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower[k] <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
upper[k] <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
}
level[i,j] <- mean((lower<p)&(upper>p))
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=1000","n=5000","n=10000")
level
p <- 0.7
m <- 1000
n <- c(100,1000,10000)
alpha <- c(0.05,0.5,0.95)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
lower = numeric(m)
upper = numeric(m)
for(k in 1:m){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower[k] <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
upper[k] <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
}
level[i,j] <- mean((lower<p)&(upper>p))
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=100","n=1000","n=10000")
level
set.seed(123)
p <- 0.7
m <- 1000
n <- c(100,1000,10000)
alpha <- c(0.05,0.5,0.95)
level <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
lower = numeric(m)
upper = numeric(m)
for(k in 1:m){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower[k] <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
upper[k] <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat))
}
level[i,j] <- mean((lower<p)&(upper>p))
}
}
colnames(level) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level) <- c("n=100","n=1000","n=10000")
level
set.seed(123)
p <- 0.7
m <- 1000
n <- c(100,1000,10000)
alpha <- c(0.05,0.5,0.95)
level1 <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
lower = numeric(m)
upper = numeric(m)
for(k in 1:m){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower[k] <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat)*n/(n-1))
upper[k] <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat)*n/(n-1))
}
level1[i,j] <- mean((lower<p)&(upper>p))
}
}
colnames(level1) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level1) <- c("n=100","n=1000","n=10000")
level1
set.seed(123)
p <- 0.7
m <- 1000
n <- c(100,1000,10000)
alpha <- c(0.05,0.5,0.95)
level1 <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
lower = numeric(m)
upper = numeric(m)
for(k in 1:m){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower[k] <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat)*n[i]/(n[]-1))
upper[k] <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat)*n/(n-1))
}
level1[i,j] <- mean((lower<p)&(upper>p))
}
}
colnames(level1) <- c("alpha=0.05","alpha=0.5","alpha=0.95")
rownames(level1) <- c("n=100","n=1000","n=10000")
level1
set.seed(123)
p <- 0.7
m <- 1000
n <- c(100,1000,10000)
alpha <- c(0.05,0.5,0.95)
level1 <- matrix(0,3,3)
for(i in 1:length(n)){
for(j in 1:length(alpha)){
lower = numeric(m)
upper = numeric(m)
for(k in 1:m){
s <- rbinom(n[i],1,p)
p_hat <- mean(s)
lower[k] <- p_hat-qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat)*n[i]/(n[i]-1))
upper[k] <- p_hat+qnorm(1-alpha[j]/2)*sqrt(1/n[i]*p_hat*(1-p_hat)*n[i]/(n[i]-1))
}
level1[i,j] <- mean((lower<p)&(upper>p))
}
}
